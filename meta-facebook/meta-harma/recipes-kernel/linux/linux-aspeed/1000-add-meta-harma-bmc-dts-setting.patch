From f0b3fb82e042e1218861ca104064a0172be24a50 Mon Sep 17 00:00:00 2001
From: Peter Yin <peteryin.openbmc@gmail.com>
Date: Mon, 1 Apr 2024 13:15:31 +0800
Subject: [PATCH 1/1] update harma dts

---
 .../dts/aspeed/aspeed-bmc-facebook-harma.dts  | 48 ++++++++++++++++---
 1 file changed, 41 insertions(+), 7 deletions(-)

diff --git a/arch/arm/boot/dts/aspeed/aspeed-bmc-facebook-harma.dts b/arch/arm/boot/dts/aspeed/aspeed-bmc-facebook-harma.dts
index bbbab8023cd6..eaae2de1bdae 100644
--- a/arch/arm/boot/dts/aspeed/aspeed-bmc-facebook-harma.dts
+++ b/arch/arm/boot/dts/aspeed/aspeed-bmc-facebook-harma.dts
@@ -179,6 +179,16 @@ flash@0 {
 	};
 };
 
+&lpc_pcc {
+	rec-mode = <0x1>;
+	port-addr = <0x80>;
+	port-addr-hbits-select = <0x1>;
+	port-addr-xbits = <0x3>;
+	dma-mode;
+	A2600-15;
+	status = "okay";
+};
+
 &kcs2 {
 	status = "okay";
 	aspeed,lpc-io-reg = <0xca8>;
@@ -192,7 +202,7 @@ &kcs3 {
 &i2c0 {
 	status = "okay";
 
-	max31790@5e{
+	pwm@5e{
 		compatible = "max31790";
 		reg = <0x5e>;
 		#address-cells = <1>;
@@ -203,7 +213,7 @@ max31790@5e{
 &i2c1 {
 	status = "okay";
 
-	tmp75@4b {
+	temperature-sensor@4b {
 		compatible = "ti,tmp75";
 		reg = <0x4b>;
 	};
@@ -218,7 +228,7 @@ eeprom@50 {
 &i2c2 {
 	status = "okay";
 
-	max31790@5e{
+	pwm@5e{
 		compatible = "max31790";
 		reg = <0x5e>;
 		#address-cells = <1>;
@@ -250,6 +260,10 @@ imux21: i2c@1 {
 			#address-cells = <1>;
 			#size-cells = <0>;
 			reg = <1>;
+			retimer@24 {
+				compatible = "asteralabs,pt5161l";
+				reg = <0x24>;
+			};
 		};
 	};
 };
@@ -262,12 +276,12 @@ eeprom@52 {
 		reg = <0x52>;
 	};
 
-	delta_brick@69 {
+	power-monitor@69 {
 		compatible = "pmbus";
 		reg = <0x69>;
 	};
 
-	tmp75@49 {
+	temperature-sensor@49 {
 		compatible = "ti,tmp75";
 		reg = <0x49>;
 	};
@@ -308,6 +322,16 @@ imux23: i2c@1 {
 
 &i2c7 {
 	status = "okay";
+	sbrmi@3C {
+		compatible = "amd,sbrmi";
+		reg = <0x3C>;
+		dimm-count = <8>;
+		dimm-ids = <0x00 0x01 0x02 0x03 0x10 0x11 0x12 0x13>;
+	};
+	sbtsi@4C {
+		compatible = "amd,sbtsi";
+		reg = <0x4C>;
+	};
 };
 
 &i2c8 {
@@ -328,6 +352,12 @@ gpio@31 {
 		reg = <0x31>;
 		gpio-controller;
 		#gpio-cells = <2>;
+
+		gpio-line-names =
+		"","","","",
+		"","","presence-cmm","",
+		"","","","leakage-detect-alert",
+		"","","","";
 	};
 
 	i2c-mux@71 {
@@ -370,6 +400,10 @@ &i2c11 {
 
 &i2c12 {
 	status = "okay";
+	retimer@24 {
+		compatible = "asteralabs,pt5161l";
+		reg = <0x24>;
+	};
 };
 
 &i2c13 {
@@ -540,10 +574,10 @@ &sgpiom0 {
 	"","reset-control-cpu0-p1-mux",
 	"","reset-control-e1s-mux",
 	"power-host-good","reset-control-mb-mux",
-	"power-cpu-good","reset-control-smb-e1s-0",
+	"host0-ready","reset-control-smb-e1s-0",
 	/*E0-E3 line 64-71*/
 	"","reset-control-smb-e1s-1",
-	"host-ready-n","reset-control-srst",
+	"post-end-n","reset-control-srst",
 	"presence-e1s-0","reset-control-usb-hub",
 	"","reset-control",
 	/*E4-E7 line 72-79*/
-- 
2.25.1

